var resultado  = [{"codTaxaAdministrativa":322,"codEmp":88130,"codLoja":570806763,"codOperadora":1,"codProduto":1,"nmeLoja":"000000000001002","nmeOperadora":"AMEX","nmeProduto":"AMEX","codUsuario":2835,"nroPlano1":null,"nroPlano2":null,"nroPlano3":null,"nroPlano4":null,"nroPlano5":null,"nroPlano6":null,"nroPlano7":null,"nroPlano8":null,"nroPlano9":null,"nroPlano11":null,"nroPlano12":null,"listaSalvar":[],"mapaId":{"PLANO_2":322},"nro_plano10":null},{"codTaxaAdministrativa":321,"codEmp":88130,"codLoja":570806763,"codOperadora":1,"codProduto":1,"nmeLoja":"000000000001002","nmeOperadora":"AMEX","nmeProduto":"AMEX","codUsuario":2835,"nroPlano1":0.2,"nroPlano2":null,"nroPlano3":null,"nroPlano4":null,"nroPlano5":null,"nroPlano6":null,"nroPlano7":null,"nroPlano8":null,"nroPlano9":null,"nroPlano11":null,"nroPlano12":null,"listaSalvar":[],"mapaId":{"PLANO_1":321},"nro_plano10":null},{"codTaxaAdministrativa":441,"codEmp":88130,"codLoja":570831708,"codOperadora":1,"codProduto":1,"nmeLoja":"9919240580","nmeOperadora":"AMEX","nmeProduto":"AMEX","codUsuario":2835,"nroPlano1":0.05,"nroPlano2":null,"nroPlano3":null,"nroPlano4":null,"nroPlano5":null,"nroPlano6":null,"nroPlano7":null,"nroPlano8":null,"nroPlano9":null,"nroPlano11":null,"nroPlano12":null,"listaSalvar":[],"mapaId":{"PLANO_1":441},"nro_plano10":null},{"codTaxaAdministrativa":323,"codEmp":88130,"codLoja":570806763,"codOperadora":1,"codProduto":1,"nmeLoja":"000000000001002","nmeOperadora":"AMEX","nmeProduto":"AMEX","codUsuario":2835,"nroPlano1":null,"nroPlano2":null,"nroPlano3":null,"nroPlano4":null,"nroPlano5":null,"nroPlano6":null,"nroPlano7":null,"nroPlano8":null,"nroPlano9":null,"nroPlano11":null,"nroPlano12":null,"listaSalvar":[],"mapaId":{"PLANO_5":323},"nro_plano10":null},{"codTaxaAdministrativa":1081,"codEmp":88130,"codLoja":570806763,"codOperadora":1,"codProduto":1,"nmeLoja":"000000000001002","nmeOperadora":"AMEX","nmeProduto":"AMEX","codUsuario":2835,"nroPlano1":null,"nroPlano2":null,"nroPlano3":null,"nroPlano4":null,"nroPlano5":null,"nroPlano6":null,"nroPlano7":null,"nroPlano8":null,"nroPlano9":null,"nroPlano11":null,"nroPlano12":null,"listaSalvar":[],"mapaId":{"PLANO_2":1081},"nro_plano10":null},{"codTaxaAdministrativa":1042,"codEmp":88130,"codLoja":570806763,"codOperadora":1,"codProduto":1,"nmeLoja":"000000000001002","nmeOperadora":"AMEX","nmeProduto":"AMEX","codUsuario":2835,"nroPlano1":0.1,"nroPlano2":null,"nroPlano3":null,"nroPlano4":null,"nroPlano5":null,"nroPlano6":null,"nroPlano7":null,"nroPlano8":null,"nroPlano9":null,"nroPlano11":null,"nroPlano12":null,"listaSalvar":[],"mapaId":{"PLANO_1":1042},"nro_plano10":null},{"codTaxaAdministrativa":1041,"codEmp":88130,"codLoja":570806763,"codOperadora":1,"codProduto":1,"nmeLoja":"000000000001002","nmeOperadora":"AMEX","nmeProduto":"AMEX","codUsuario":2835,"nroPlano1":null,"nroPlano2":null,"nroPlano3":null,"nroPlano4":null,"nroPlano5":null,"nroPlano6":null,"nroPlano7":null,"nroPlano8":null,"nroPlano9":null,"nroPlano11":null,"nroPlano12":null,"listaSalvar":[],"mapaId":{"PLANO_1":1041},"nro_plano10":null},{"codTaxaAdministrativa":481,"codEmp":88130,"codLoja":570839723,"codOperadora":1,"codProduto":1,"nmeLoja":"000000000027652","nmeOperadora":"AMEX","nmeProduto":"AMEX","codUsuario":2835,"nroPlano1":0.02,"nroPlano2":null,"nroPlano3":null,"nroPlano4":null,"nroPlano5":null,"nroPlano6":null,"nroPlano7":null,"nroPlano8":null,"nroPlano9":null,"nroPlano11":null,"nroPlano12":null,"listaSalvar":[],"mapaId":{"PLANO_1":481},"nro_plano10":null},{"codTaxaAdministrativa":1067,"codEmp":88130,"codLoja":570806763,"codOperadora":1,"codProduto":1,"nmeLoja":"000000000001002","nmeOperadora":"AMEX","nmeProduto":"AMEX","codUsuario":2835,"nroPlano1":null,"nroPlano2":null,"nroPlano3":15,"nroPlano4":null,"nroPlano5":null,"nroPlano6":null,"nroPlano7":null,"nroPlano8":null,"nroPlano9":null,"nroPlano11":null,"nroPlano12":null,"listaSalvar":[],"mapaId":{"PLANO_3":1067},"nro_plano10":null},{"codTaxaAdministrativa":1066,"codEmp":88130,"codLoja":570806763,"codOperadora":1,"codProduto":1,"nmeLoja":"000000000001002","nmeOperadora":"AMEX","nmeProduto":"AMEX","codUsuario":2835,"nroPlano1":null,"nroPlano2":10,"nroPlano3":null,"nroPlano4":null,"nroPlano5":null,"nroPlano6":null,"nroPlano7":null,"nroPlano8":null,"nroPlano9":null,"nroPlano11":null,"nroPlano12":null,"listaSalvar":[],"mapaId":{"PLANO_2":1066},"nro_plano10":null},{"codTaxaAdministrativa":1065,"codEmp":88130,"codLoja":570806763,"codOperadora":1,"codProduto":1,"nmeLoja":"000000000001002","nmeOperadora":"AMEX","nmeProduto":"AMEX","codUsuario":2835,"nroPlano1":null,"nroPlano2":null,"nroPlano3":3,"nroPlano4":null,"nroPlano5":null,"nroPlano6":null,"nroPlano7":null,"nroPlano8":null,"nroPlano9":null,"nroPlano11":null,"nroPlano12":null,"listaSalvar":[],"mapaId":{"PLANO_3":1065},"nro_plano10":null},{"codTaxaAdministrativa":1064,"codEmp":88130,"codLoja":570806763,"codOperadora":1,"codProduto":1,"nmeLoja":"000000000001002","nmeOperadora":"AMEX","nmeProduto":"AMEX","codUsuario":2835,"nroPlano1":null,"nroPlano2":2,"nroPlano3":null,"nroPlano4":null,"nroPlano5":null,"nroPlano6":null,"nroPlano7":null,"nroPlano8":null,"nroPlano9":null,"nroPlano11":null,"nroPlano12":null,"listaSalvar":[],"mapaId":{"PLANO_2":1064},"nro_plano10":null},{"codTaxaAdministrativa":1063,"codEmp":88130,"codLoja":570806763,"codOperadora":1,"codProduto":1,"nmeLoja":"000000000001002","nmeOperadora":"AMEX","nmeProduto":"AMEX","codUsuario":2835,"nroPlano1":null,"nroPlano2":null,"nroPlano3":3,"nroPlano4":null,"nroPlano5":null,"nroPlano6":null,"nroPlano7":null,"nroPlano8":null,"nroPlano9":null,"nroPlano11":null,"nroPlano12":null,"listaSalvar":[],"mapaId":{"PLANO_3":1063},"nro_plano10":null},{"codTaxaAdministrativa":1062,"codEmp":88130,"codLoja":570806763,"codOperadora":1,"codProduto":1,"nmeLoja":"000000000001002","nmeOperadora":"AMEX","nmeProduto":"AMEX","codUsuario":2835,"nroPlano1":null,"nroPlano2":2,"nroPlano3":null,"nroPlano4":null,"nroPlano5":null,"nroPlano6":null,"nroPlano7":null,"nroPlano8":null,"nroPlano9":null,"nroPlano11":null,"nroPlano12":null,"listaSalvar":[],"mapaId":{"PLANO_2":1062},"nro_plano10":null},{"codTaxaAdministrativa":1061,"codEmp":88130,"codLoja":570806763,"codOperadora":1,"codProduto":1,"nmeLoja":"000000000001002","nmeOperadora":"AMEX","nmeProduto":"AMEX","codUsuario":2835,"nroPlano1":null,"nroPlano2":2,"nroPlano3":null,"nroPlano4":null,"nroPlano5":null,"nroPlano6":null,"nroPlano7":null,"nroPlano8":null,"nroPlano9":null,"nroPlano11":null,"nroPlano12":null,"listaSalvar":[],"mapaId":{"PLANO_2":1061},"nro_plano10":null},{"codTaxaAdministrativa":983,"codEmp":88130,"codLoja":570839723,"codOperadora":1,"codProduto":1,"nmeLoja":"000000000027652","nmeOperadora":"AMEX","nmeProduto":"AMEX","codUsuario":2835,"nroPlano1":null,"nroPlano2":0.35,"nroPlano3":null,"nroPlano4":null,"nroPlano5":null,"nroPlano6":null,"nroPlano7":null,"nroPlano8":null,"nroPlano9":null,"nroPlano11":null,"nroPlano12":null,"listaSalvar":[],"mapaId":{"PLANO_2":983},"nro_plano10":null}]
var resultadoFiltrado = [];
var chaves = []; //codLoja + codOperadora + codProduto




// array de taxas sem repeticao
resultado.forEach(taxa => {
  var chaveAux = taxa.codLoja + "" + taxa.codOperadora + "" + taxa.codProduto;
  if(!chaves.includes(chaveAux)) {
    chaves.push(chaveAux);
  }
});
console.log(chaves.length); //3 amex diferentes

// compara cada taxa (unica) com as taxas do resultado
chaves.forEach(chave => {
  resultado.forEach(taxa => {
    var chaveTaxa = taxa.codLoja + "" + taxa.codOperadora + "" + taxa.codProduto;
    if((chave === chaveTaxa) && resultadoFiltrado.length === 0) {
      resultadoFiltrado.push(taxa);
    }

    if(chave === chaveTaxa){
      confereTaxa(taxa);
    }
  })
});


function confereTaxa(taxa) {
  var chaveTaxa = taxa.codLoja + "" + taxa.codOperadora + "" + taxa.codProduto;
  for(var i = 0; i < resultadoFiltrado.length; i++) {
    var chaveTaxaFiltrada = resultadoFiltrado[i].codLoja + "" + resultadoFiltrado[i].codOperadora + "" + resultadoFiltrado[i].codProduto;
    var taxaFiltrada = resultadoFiltrado[i];
    if(chaveTaxa === chaveTaxaFiltrada) {
      if(taxa.mapaId != taxaFiltrada.mapaId) {
        atualizaNroPlano(taxa, taxaFiltrada);
      }
    }
  }
}

function atualizaNroPlano(taxa, taxaFiltrada) {
  var nroPlano = "nroPlano";
  var nroPlanoTaxa = Object.keys(taxa.mapaId)[0].replace("PLANO_", "");
  var nroPlanoTaxaFiltrada = Object.keys(taxaFiltrada.mapaId)[0].replace("PLANO_", "");
  if(nroPlanoTaxa != nroPlanoTaxaFiltrada) {
    nroPlano = nroPlano + nroPlanoTaxa;
    // console.log(nroPlano, taxaFiltrada.nroPlano);
    // nroPlano = nroPlano + nroPlanoTaxa;
    // console.log(nroPlano + nroPlanoTaxa)
  }
}

// console.log(resultadoFiltrado)



// console.log(codsLojas)


// var arr1 = ["a", "b", "c"]
// var arr2 = ["d", "e", "f"]

// arr1.forEach(a1 =>{
  
//   arr2.forEach(a2 =>{
//     console.log(a1, a2)
//   })
  
// })


// console.log(resultado.length)
// console.log(codsLojas.length)
// console.log("fim");

// resultadoFiltrado.forEach(element => {
//   console.log(element.codLoja)
// })